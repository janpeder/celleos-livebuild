\input texdraw
\input epsf

\special{papersize=210mm,297.6mm} % A4 paper

\font\ftitteltop=cmcsc10 at 32pt
\font\ftittelbottom=cmcsc10 at 28pt
\font\ftopptekst=cmr10 at 6pt
\font\ftopptekststor=cmr10 at 7.8pt
\font\fforfatter=cmr10 at 6pt
\font\fs=cmbx10 scaled\magstep2
\font\fss=cmcsc10 scaled\magstep2
\font\fc=cmr8

\def\imagewithcaption#1#2#3{
\centerline{
\vbox{\hbox{\epsfxsize #1 \epsffile{#2}}
\vskip 2pt
\hbox{\raise 4pt \vbox{\hsize=#1 \noindent \fc \baselineskip=9pt #3}}}}}

\headline={\ftopptekststor B\kern+0.1pt{\ftopptekst RUKERMANUAL FOR } C\kern+0.1pt{\ftopptekst ELLEOS \hfill Jan Peder David-Andersen, januar 2023}}

\topglue 6pc
\centerline{\ftitteltop Brukermanual}
\vskip 10pt
\centerline{\ftittelbottom for Celleos}
\vskip 8pc

\noindent Skrevet av: Jan Peder David-Andersen ({\tt peder.david-andersen@tffk.no})

\noindent Sist endret: 20. januar 2023

\vskip 3pc
\def\tocwidth{38pc}

\beginsection {\fss Innhold}

\hbox to \tocwidth{1. Beskrivelse av l\o sningen \dotfill 2}
\smallskip
\hbox to \tocwidth{1.1. Bakgrunn om Celleos og DFS \dotfill 2}
\hbox to \tocwidth{1.2. Funksjonalitet \dotfill 2}
\hbox to \tocwidth{1.3. Teknisk beskrivelse \dotfill 2}
\hbox to \tocwidth{1.4. Vurdering av sikkerheten \dotfill 2}
\medskip
\hbox to \tocwidth{2. Installasjonsveiledning \dotfill 4}
\smallskip
\hbox to \tocwidth{2.1. Klargj\o re minnepenn for installasjon \dotfill 4}
\hbox to \tocwidth{2.2. Bakgrunn om UEFI og BIOS \dotfill 4}
\hbox to \tocwidth{2.3. Klargj\o ring av datamaskin f\o r installasjon \dotfill 5}
\hbox to \tocwidth{2.4. Installasjon \dotfill 90}
\medskip
\hbox to \tocwidth{3. Sikring av datamaskin etter installasjon \dotfill 90}
\smallskip
\vfill\eject

\topglue 1pc
\beginsection {\fs 1. Beskrivelse av l\o sningen}

Celleos er et operativsystem utviklet for \aa{} kunne brukes av innsatte i norske fengsler, uten tilsyn. Det er utviklet med fokus p\aa{} sikkerhet og utdanning.


\beginsection {\fss 1.1. Bakgrunn om Celleos og DFS}

I skoleavdelingene i norske fengsler i dag benyttes datasystemet {\it Desktop for Skolen} (DFS). Dette er et funksjonelt og sikkert system som gj\o r det mulig for elever i fengsler \aa{} gj\o re skolearbeid p\aa{} datamaskin i skoletiden. DFS gir en begrenset internettilgang, samtidig som det oppfyller n\o dvendige krav til sikkerhet.

Elever som \o nsker \aa{} bruke datamaskin til skolearbeid p\aa{} kveldstid har i utgangspunktet ikke mulighet til dette i norske fengsler. Enkelte fengsler har bestemt lokalt at skoleavdelingene f\aa r lov til \aa{} dele ut datamaskiner til utvalgte elever. Elevene har disse maskinene p\aa{} sin celle og de brukes uten tilsyn. Av sikkerhetshensyn er det derfor viktig at det ikke er mulig \aa{} kommunisere ved hjelp av disse maskinene.

Celleos er et operativsystem som er utviklet for datamaskiner som elevene har p\aa{} cella. Form\aa let med Celleos er at det skal v\ae re lett og raskt \aa{} installere, at det skal v\ae re sikkert og at det skal inneholde den viktigste programvaren som elever har bruk for i en skolesituasjon. Celleos gir ingen mulighet for internettforbindelse eller annen kommunikasjon, da dette ikke lar seg gj\o re av sikkerhetshensyn.

\beginsection {\fss 1.2. Funksjonalitet}

Celleos installeres av skolens systemansvarlige ved hjelp av en minnepenn. Selve installasjonsprosessen er automatisert s\aa{} langt det lar seg gj\o re. Etter installasjonen m\aa{} skolens systemansvarlige sikre maskinen. Dette m\aa{} gj\o res manuelt da det involverer noen fysiske steg, samt noen instillinger i datamaskinens oppsett, som ikke kan automatiseres. N\aa r systemet er installert og maskinen er sikret er den klar til utlevering til elev.

Celleos inneholder mye nyttig skolerelatert programvare slik som program for tekstbehandling, presentasjon, regneark, bildebehandling, {\it GeoGebra}, programmering i {\it Python}, {\it Sketchup} og mye annet.

Systemet gj\o r det umulig \aa{} koble maskinen til Internett eller annet nettverk. USB-tilkoblinger blir ogs\aa{} sperret slik at det eneste som g\aa r an \aa{} koble til er tastatur, mus og skjerm. Det er mulig \aa{} sette det opp slik at godkjente minnepenner kan kobles til systemet. Godkjenning av minnepenner baserer seg p\aa{} {\it VID/PID} som er samme prinsippet som DFS bruker.

Celleos er laget for \aa{} fungere p\aa{} noks\aa{} gamle datamaskiner. Ettersom PC p\aa{} celle ikke er en rettighet elevene har, settes det vanligvis ikke av mye penger til dette i skolens budsjett. Derfor er det fint \aa{} ha muligheten til \aa{} bruke eldre datautstyr til dette. I tillegg sparer man b\aa de penger og milj\o et ved \aa{} gjenbruke datautstyr som kanskje ellers ville blitt kastet.

\beginsection {\fss 1.3. Teknisk beskrivelse}

Celleos er basert p\aa{} {\it Debian GNU/Linux}. Automatiseringen av installasjonen av Celleos er gjort ved hjelp av verkt\o yet {\it live-build}, som er en del av Debian-prosjektet. Sperring av USB-enheter gj\o res med programvaren {\it USBGuard} og sperring av nettverksforbindelser gj\o res med brannmuren {\it iptables}. Mer detaljer om Celleos-prosjektet kan finnes p\aa{} prosjektet sin {\it github}-side:
\smallskip
\noindent {\tt https://github.com/janpeder/celleos-livebuild}

\beginsection {\fss 1.4. Vurdering av sikkerheten}

Trusselbildet forbundet med datamaskin p\aa{} celle g\aa r i hovedsak ut p\aa{} at en elev benytter en slik datamaskin til \aa{} kommunisere med andre. Verste tenkelige situasjon er at en domfelt benytter en datamaskin utlevert av skolen til \aa{} kontakte forn\ae rmede i sak eller planlegge ny kriminalitet.
Tabellen p\aa{} neste side beskriver ulike hendelser som kan utgj\o re en sikkerhetstrussel, og hvordan Celleos beskytter mot disse. De fleste av hendelsene som er beskrevet forutsetter at det har blitt smuglet inn en liten maskinvare-enhet som muliggj\o r kommunikasjon. Dette kan for eksempel v\ae re et {\it modem} som muliggj\o r internettforbindelse over mobilnettet. Slike enheter kan kobles til datamaskinens USB-kontakt, nettverkskontakt eller tilkobles ved hjelp av {\it BlueTooth}. Se tabellen p\aa{} neste side.

\vfill\eject
\topglue 1pc

\def\firstcolwidth{12pc}
\def\secondcolwidth{19pc}
\def\tablerow#1#2{
\vbox{
\btexdraw
\drawdim pc
\textref h:L v:T
\move(0 0) \htext{\vbox{\hsize=\firstcolwidth \noindent\raggedright #1}}
\move(16 0) \htext{\vbox{\hsize=\secondcolwidth \noindent\raggedright #2}}
\etexdraw
}}
\def\tablehline{
\vbox{
\btexdraw
\drawdim pc
\move(0 0) \linewd 0.01 \lvec(35 0)
\etexdraw}
}

\def\tabletopline{
\vbox{
\btexdraw
\drawdim pc
\move(0 0) \linewd 0.07 \lvec(35 0)
\move(0 0.1) \linewd 0.02 \lvec(35 0.1)
\etexdraw}
}
\def\tablebottomline{
\vbox{
\btexdraw
\drawdim pc
\move(0 0) \linewd 0.07 \lvec(35 0)
\move(0 -0.1) \linewd 0.02 \lvec(35 -0.1)
\etexdraw}
}

\tablerow{\it Sikkerhetstrussel}{\it Beskyttelse mot trussel i Celleos}
\smallskip
\tabletopline
\tablerow{Elev benytter tr\aa dl\o st nettverk innebygd i datamaskin til \aa{} kommunisere med andre.}{En viktig forutsetning for \aa{} ivareta sikkerhet er at tr\aa dl\o se nettverkskort m\aa{} v\ae re fysisk fjernet fra datamaskinen f\o r den gis til elev.}
\vskip 2.55pc
\tablehline
\tablerow{Elev kobler USB-enhet til datamaskinen som gir internett\-forbindelse (for eksempel et {\it 4G-modem\/}).}{Programvare {\it (USBGuard)} blokk\-erer alle USB-enheter unntatt tastatur, mus og lagrings\-enheter med godkjent {\it produkt-ID (VID/PID)}. (Godkjenning av USB-lagringsenheter basert p\aa{} VID/PID benyttes ogs\aa{} i DFS.) I tillegg til dette er all kommunikasjon over IPv4 og IPv6 blokkert ved hjelp av brannmur {\it (iptables)}.}
\vskip 6.5pc
\tablehline
\tablerow{Elev kobler en liten {\it WiFi-ruter} til nettverkskontakt p\aa{} datamaskin og kommuniserer med andre.}{All kommunikasjon over IPv4 og IPv6 er blokkert ved hjelp av brannmur {\it (iptables)}.}
\vskip 3.5pc
\tablehline
\tablerow{Elev kobler ekstern nett\-verks\-enhet til datamaskinen over {\it BlueTooth} og bruker dette til \aa{} kommunisere med andre.}{All kommunikasjon over IPv4 og IPv6 er blokkert ved hjelp av brannmur {\it (iptables)}.}
\vskip 3.5pc
\tablehline
\tablerow{Elev \aa pner datamaskinen og monterer ny maskinvare som muliggj\o r kommunikasjon.}{Kabinett p\aa{} datamaskin forsegles med forseglings\-teip, slik at det vil vises i ettertid om maskinen har blitt \aa pnet av elev.}
\vskip 2.5pc
\tablehline
\tablerow{Elev installerer nytt operativsystem p\aa{} datamaskinen og f\aa r p\aa{} denne m\aa ten {\it administrator-rettigheter}. Deretter tilkobles for eksempel et eksternt tr\aa dl\o st nettverkskort til USB-kontakten for \aa{} muliggj\o re kommunikasjon.}{{\it BIOS/UEFI} innstillinger p\aa{} datamaskinen m\aa{} endres slik at det ikke er mulig \aa{} laste inn operativ\-system fra nettverk, USB, CDROM eller andre eksterne medier. Det er viktig at skolen har gode rutiner for kontroll av dette f\o r datamaskinen leveres ut til elev.}
\vskip 6.5pc
\tablehline
\tablerow{Elev \aa pner datamaskinen og monterer ny harddisk med nytt operativsystem og f\aa r p\aa{} denne m\aa ten {\it administrator-rettigheter}. Se hendelsen over for hvordan administrator-rettigheter kan utnyttes.}{Kabinett p\aa{} datamaskin forsegles med forseglings\-teip, slik at det vil vises i ettertid om maskinen har blitt \aa pnet av elev.}
\vskip 6.8pc
\tablebottomline

\vfill\eject

\topglue 1pc
\beginsection {\fs 2. Installasjonsveiledning}

Celleos installeres ved at man f\o rst laster ned en {\it avbildingsfil} og skriver denne til en minnepenn. Deretter installerer man Celleos ved hjelp av minnepennen. Her f\o lger en detaljert beskrivelse av hvordan dette gj\o res.

\beginsection {\fss 2.1. Klargj\o re minnepenn for installasjon}

For \aa{} lage installasjonsminnepennen trenger du en minnepenn med minimum 4GB kapasitet og en datamaskin med internettforbindelse. Alt p\aa{} minnepennen vil bli overskrevet, s\aa{} s\o rg for \aa{} ta kopi av alt du vil ta vare p\aa{} f\o r du begynner. Se instruksjon nedenfor.
\item{1.} Bes\o k f\o lgende nettadresse og last ned en {\it avbildingsfil} for Celleos. Dersom det finnes flere versjoner velger du den som har den nyeste datoen i filnavnet.
\vskip 1pt
{\tt https://www.mediafire.com/folder/y0ff1nlbepsa8/celleos}
\vskip 1pt
\item{2.} Avbildingsfilen er stor og nedlastingen kan derfor ta en stund. N\aa r den er ferdig skal du laste ned og installerere programmet {\it Rufus}. Rufus finner du p\aa{} nettadressen under. 
\vskip 1pt
{\tt https://rufus.ie/}
\vskip 1.5pc
\imagewithcaption{5.5cm}{bilder/rufus-nedlastning.eps}{For \aa{} finne lenken du skal trykke p\aa{} m\aa{} du rulle nedover p\aa{} nettsiden.}
\vskip 1.5pc
\item{3.} Koble minnepennen du vil bruke til PCens USB-kontakt. {\it (Husk at alt p\aa{} minnepennen vil bli overskrevet.)}

\vfill\eject
\item{4.} \AA pne Rufus, som du nettopp lastet ned. Programmet Rufus er vist p\aa{} bildet under.

\vskip 1.5pc
\item{}\hbox{\epsfxsize 6.5cm\epsffile{bilder/rufus.eps}}\hskip 4pt \hbox{\raise 15.5pc \vbox{\hsize=4.5cm \noindent \raggedright \fc \baselineskip=9pt Program\-met Rufus. Trykk p\aa{} (1) for \aa{} velge minne\-pennen du vil bruke. Trykk p\aa{} (2) og velg avbildings\-filen du lastet ned. Trykk p\aa{} (3) for \aa{} skrive avbildings\-filen til minne\-pennen.}}
\vskip 1.5pc
\item{5.} I vinduet velger du hvilken USB-enhet du vil skrive avbildings\-filen til. S\aa{} velger du at avbildings\-filen du lastet ned er den som skal skrives til minnepennen. Til slutt trykker du p\aa{} ``Start''.

\item{6.} N\aa{} kommer det opp en dialogboks som sp\o r om hvordan bildet skal skrives. Her skal du velge ``Skriv i DD-bilde - modus''. Se bildet under.
\vskip 1.5pc
\imagewithcaption{7cm}{bilder/dd-modus.eps}{Her skal du velge ``Skriv i DD-bilde - modus''.}
\vskip 1.5pc
\item{7.} Til slutt blir du spurt om du er sikker. Svar ``Ok'' p\aa{} dette. Det tar en stund \aa{} skrive avbildingsfilen til minnepennen. N\aa r den er ferdig er installasjons\-minnepennen klar.

\beginsection {\fss 2.2. Bakgrunn om UEFI og BIOS}

Datamaskiner er laget slik at n\aa r de sl\aa s p\aa{} startes den programvaren som ligger lagret p\aa{} begynnelsen av maskinens harddisk. Det er slik maskinen finner og starter operativsystemet. Du skal n\aa{} endre instillingene i datamaskinen slik at den i stedet starter programvaren p\aa{} minnepennen. Men f\o r vi g\aa r inn p\aa{} hvordan dette gj\o res m\aa{} det forklares litt mer i detalj om hvordan dette virker.

For at programvare skal fungere p\aa{} datamaskiner fra ulike produsenter m\aa{} produsentene bli enige om  \aa{} gj\o re enkelte ting p\aa{} samme m\aa te. Slik enighet oppn\aa s gjennom at det skrives {\it standardiseringsdokumenter}. M\aa ten datamaskinen leter etter programvare n\aa r maskinen skrus p\aa{} er standardisert slik. Hvis dette ikke var standardisert ville vi i verste fall m\aa ttet lage ulike installasjonsminnepennener for de ulike merkene --- en for Lenovo, en annen for Dell og  en tredje for HP osv. Men takket v\ae re standarden virker en minnepenn p\aa{} alle.

Men riktig s\aa{} heldige er vi likevel ikke. For p\aa{} begynnelsen av 2000-tallet ble det klart at standarden som definerte hvordan maskinen skal starte opp var gammel og utdatert og at det var behov for en ny standard. Vi har i dag derfor to ulike standarder. Den nye heter {\it Unified Extensible Firmware Interface} (UEFI). Den gamle kalles vanligvis {\it BIOS}. 

Celleos bruker BIOS som oppstartsmetode. Dette er for at det skal fungere med gamle datamaskiner som ble laget f\o r UEFI ble vanlig. 

\beginsection {\fss 2.3. Klargj\o ring av datamaskin f\o r installasjon}

For at installasjonsprogrammet p\aa{} minnepennen skal startes n\aa r maskinen skrus p\aa , m\aa{} vi endre instillingene p\aa{} datamaskinen. Den m\aa{} stilles inn p\aa{} \aa{} starte fra USB og oppstartmodus m\aa{} v\ae re {\it BIOS/Legacy/CSM (ikke UEFI)}. Fremgangsm\aa ten er ulik p\aa{} ulike datamaskiner. Her beskrives det som er felles for de ulike produsentene: 
\item{1.} Hvis datamaskinen er p\aa, skru den av.
\item{2.} Du skal n\aa{} starte opp datamaskinen og holde inne en bestemt tast. Hvilken tast du skal holde inne varierer avhengig av produsent. Det kommer vanligvis opp p\aa{} skjermen rett etter at datamaskinen startes, for eksempel kan det st\aa{} ``Press F2 to enter Setup''. De vanligste tastene er enten {\it F1}, {\it F2}, {\it F10}, {\it ENTER} eller {\it DEL}.
\item{3.} N\aa r du har gjort dette kommer du til menyen for datamaskinens innstillinger. 
\medskip
\imagewithcaption{8cm}{bilder/maskinoppsett.eps}{Eksempel p\aa{} hvordan menyen for datamaskinens opp\-sett kan se ut. Feltet nederst p\aa{} skjermen viser hvordan man bruker tastaturet for \aa{} navigere i menyen.}
\item{} I menyen finnes det et menyvalg for ``boot order'' eller tilsvarende. Dette vises gjerne som en prioritert liste. Hver gang datamaskinen skrus p\aa{} leser den lista ovenifra og ned og starter opp den f\o rste programvaren den finner. Du m\aa{} derfor endre rekkef\o lgen slik at USB-enheter er f\o rst er f\o rst i lista.
\item{4.} S\o rg for at oppstartsmodus BIOS er valgt. De ulike produsentene bruker ulike navn for dette. Noen kaller det {\it BIOS}, noen kaller det {\it Legacy} og noen kaller det {\it Compatibility Support Module (CSM)}.
\smallskip
\noindent N\aa r du har utf\o rt alle stegene i lista over vil installasjonsprogrammet for Celleos startes automatisk n\aa r minnepennen st\aa r i PCen og maskinen skrus p\aa.


\beginsection {\fss 2.4. Installasjon}

For \aa{} installere trenger du installasjons\-minnnepennen som du lagde i delkapittel 2.1. For at installasjonen skal starte m\aa{} maskinen v\ae re konfigurert for oppstart fra USB, som du gjorde i delkapittel 2.3. Mesteparten av installasjonen foreg\aa r automatisk. Det eneste man blir spurt om underveis er \aa{} bestemme et {\it root-passord}. Her f\o lger en detaljert instruksjon.
\item{1.} N\aa r du setter installasjonsminnepennen i datamaskinen og skrur p\aa{} vil du se en advarsel. Hvis du ikke f\aa r opp denne advarselen n\aa r du skrur p\aa{} maskinen er det mulig du har gjort noe galt da du konfigurerte oppstart fra USB (i delkapittel 2.3).
\vskip 1pc
\imagewithcaption{8cm}{bilder/celleos-installdialog.eps}{Skjermbilde med advarsel om at alle data p\aa{} datamaskinen vil bli slettet dersom du installerer Celleos.}
\vskip 1pc
\item{2.} Trykk {\it ENTER} hvis du er sikker p\aa{} at du vil slette alt p\aa{} maskinen og installere Celleos.
\item{3.} Etter omtrent et halvt minutt vil du bli bedt om \aa{} opprette et {\it root-passord}:
\vskip 1pc
\imagewithcaption{8cm}{bilder/root-dialog.eps}{Skjermbilde hvor man blir bedt om \aa{} opprette root-passord.}
\vskip 1pc
\item{} En {\it root-bruker} er det samme som en {\it administrator-bruker}. En person som kjenner passordet til root-brukeren har alle tilganger p\aa{} datamaskinen. Det er derfor viktig at du lager et sikkert root-passord, og at du tar godt vare p\aa{} dette passordet og passer p\aa{} at uvedkommende ikke f\aa r kjennskap til det. Skriv inn passordet to ganger og trykk ``Fortsett''.
\item{4.} Installasjonen tar omtrent 10 minutter. N\aa r den er ferdig tar du ut installasjonsminnepenna, slik at installasjonen ikke startes en gang til n\aa r maskinen omstartes.

\vfill\eject
\topglue 1pc
\beginsection {\fs 3. Sikring av datamaskin etter installasjon}

Celleos inneholder programvare som forhindrer sikkerhetsbrudd i forbindelse datamaskin p\aa{} fengselscelle. Men det er ikke alle sikkerhetstrusler som det er mulig \aa{} beskytte seg mot ved hjelp av programvare. Dersom en elev kan installere nytt operativsystem p\aa{} maskinen eller kan \aa pne maskinen (og for eksempel bytte ut harddisken), har sikkerhetsfunksjonaliteten i Celleos ikke lenger noen virkning (se vurdering av sikkerheten i delkapittel 1.4). Det er derfor kritisk at IKT driftsansvarlig ved skolen har gode rutiner for \aa{} sikre at slike hendelser ikke skjer. Her forklares hvordan man beskytter mot dette.

\beginsection{\fss 3.1 Sikring av datamaskinens oppsett}

\beginsection{\fss 3.2 Sikring av datamaskinens kabinett}

\beginsection {\fss ? Sjekkliste f\o r utlevering til elev og loggf\o ring/oversikt over maskiner}

\beginsection {\fss Administrasjon og bruk av Celleos}

-Hvordan finne svar p\aa{} sp\o rsm\aa l relatert til linux, gnome, debian osv
-Brukeren "root"
-Nullstille elevbruker i Celleos
-Hvordan \aa pne for internettforbindelse
-Hvordan \aa pne for USB-enheter

\vfill\eject\bye
